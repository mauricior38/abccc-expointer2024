/**
 * @license
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * Keyboard Hotkeys Plugin for Video.js v7
 */
/*eslint no-inner-declarations: "off"*/import videojs from"video.js";const Plugin=videojs.getPlugin("plugin");class Hotkeys extends Plugin{constructor(e,t){super(e);var r=e.el(),n=document,o={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableHoverScroll:!1,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!0,captureDocumentHotkeys:!1,documentHotkeysFocusElementFilter:function(){return!1},enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:M,rewindKey:H,forwardKey:P,volumeUpKey:x,volumeDownKey:I,muteKey:L,fullscreenKey:R,customKeys:{}};videojs.options.blockKeys=!1;var i=!1,l=1,u=2,s=3,c=4,a=5,f=6,y=7,m=videojs.mergeOptions||videojs.util.mergeOptions;t=m(o,t||{});e.on("dispose",function(){document.removeEventListener("keydown",T);e.off("keydown",T);e.off("dblclick",E);e.off("mousewheel",q);e.off("DOMMouseScroll",q)});var v=t.volumeStep,b=t.seekStep,d=t.enableMute,p=t.enableVolumeScroll,k=t.enableFullscreen,h=t.enableNumbers,w=t.enableJogStyle,K=t.alwaysCaptureHotkeys,S=t.captureDocumentHotkeys,g=t.enableModifiersForNumbers,j=t.enableInactiveFocus,F=t.skipInitialFocus;if(!r.hasAttribute("tabIndex"))r.setAttribute("tabIndex","-1");r.style.outline="none";if(K||!e.autoplay())if(!F)e.one("play",function(){r.focus()});if(j)e.on("userinactive",function(){var t=function(){clearTimeout(o)},o=setTimeout(function(){e.off("useractive",t);var o=n.activeElement,i=r.querySelector(".vjs-control-bar");if(o&&o.parentElement===i)r.focus()},10);e.one("useractive",t)});e.on("play",function(){var e=r.querySelector(".iframeblocker");if(e&&""===e.style.display){e.style.display="block";e.style.bottom="39px"}});var T=function(o){var m,p=o.which;if(o.shiftKey)if(188!==p&&190!==p)return;if(!o.ctrlKey)if(!o.altKey)if(e.controls()){var j=n.activeElement;if(K||j===r||j===r.querySelector(".vjs-tech")||j===r.querySelector(".vjs-control-bar")||j===r.querySelector(".iframeblocker")){o.preventDefault();if(K||S)if(o.stopPropagation)o.stopPropagation();else if(window.event)window.event.cancelBubble=!0;if(70===p||77===p||32===p||179===p)if(i)return;i=!0;var F=e.playbackRates();if(o.shiftKey&&188===p){F.sort(function(e,t){return t-e});for(var T=0;T<F.length;T++)if(F[T]<e.playbackRate()){e.setRate(F[T]);break}}if(o.shiftKey&&190===p){F.sort(function(e,t){return e-t});for(T=0;T<F.length;T++)if(F[T]>e.playbackRate()){e.setRate(F[T]);break}}switch(D(o,e)){case l:if(e.paused())e.play();else e.pause();break;case u:if(videojs.options.blockKeys)break;m=e.currentTime()-b;if(e.currentTime()<=b)m=0;e.currentTime(m);break;case s:if(videojs.options.blockKeys)break;e.currentTime(e.currentTime()+b);break;case a:o.stopPropagation();if(videojs.options.blockKeys)break;if(!w)e.volume(e.volume()-v);else{m=e.currentTime()-1;if(e.currentTime()<=1)m=0;e.currentTime(m)}break;case c:if(videojs.options.blockKeys)break;if(!w)e.volume(e.volume()+v);else e.currentTime(e.currentTime()+1);break;case f:if(d)e.muted(!e.muted());break;case y:if(k)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen();break;default:if((p>47&&p<59)||(p>95&&p<106))if(g||!(o.metaKey||o.ctrlKey||o.altKey))if(h){var E=48;if(p>95)E=96;var q=p-E;o.preventDefault();e.currentTime(e.duration()*q*.1)}for(var M in t.customKeys){var H=t.customKeys[M];if(H&&H.key&&H.handler)if(H.key(o)){o.preventDefault();H.handler(e,t)}}}}}},E=function(t){if(e.controls()){var o=t.relatedTarget||t.toElement||n.activeElement;if(o===r||o===r.querySelector(".vjs-tech")||o===r.querySelector(".iframeblocker"))if(k)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen()}},q=function(t){if(e.controls()){var o=t.relatedTarget||t.toElement||n.activeElement;if(K||o===r||o===r.querySelector(".vjs-tech")||o===r.querySelector(".iframeblocker")||o===r.querySelector(".vjs-control-bar"))if(p){t=window.event||t;var i=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault();if(1===i)e.volume(e.volume()+v);else if(-1===i)e.volume(e.volume()-v)}}},D=function(e,r){if(t.playPauseKey(e,r))return l;if(t.rewindKey(e,r))return u;if(t.forwardKey(e,r))return s;if(t.volumeUpKey(e,r))return c;if(t.volumeDownKey(e,r))return a;if(t.muteKey(e,r))return f;if(t.fullscreenKey(e,r))return y;else return};function M(e){return 32===e.which||179===e.which}function H(e){return 37===e.which||177===e.which}function P(e){return 39===e.which||176===e.which}function x(e){return 38===e.which}function I(e){return 40===e.which}function L(e){return 77===e.which}function R(e){return 70===e.which}document.addEventListener("keydown",T,!1);document.addEventListener("keyup",N,!1);e.on("dispose",function(){document.removeEventListener("keydown",T);document.removeEventListener("keyup",N)});function N(){i=!1}e.on("keydown",T);e.on("dblclick",E);e.on("mousewheel",q);e.on("DOMMouseScroll",q);return this}}videojs.registerPlugin("hotkeys",Hotkeys);export default Hotkeys;